import{b as Ne,g as m,d as z,r as ye,a as we,p as Ce,I as Q,c as xe,e as Y,i as Fe,m as ne,s as se,E as qe,f as Be,h as Ve,j as He,k as We,l as je,n as ze,o as Ye,q as Ge,t as B,u as G,v as Je,w as Xe,x as X,y as Ke,z as Qe,L as Ze,A as et,S as tt,B as nt,C as at,P as rt,D as st,R as ot,F as oe,G as ie,H as it,J as lt,K as ut,M as ke,N as Se,O as ct,Q as dt,T as Ee,U as V,V as R,W as F,X as Re,Y as M,Z as Ue,_ as le,$ as ue,a0 as ce,a1 as de,a2 as ft,a3 as pt}from"./legacy-CU8Tr-xf.js";import{p as vt,R as A}from"./interfaces-Dq7mtQWd.js";let Ie=!1;function fe(e,t){return t}function _t(e,t,n,r){for(var l=[],v=t.length,x=0;x<v;x++)Be(t[x].e,l,!0);var p=v>0&&l.length===0&&n!==null;if(p){var g=n.parentNode;Ve(g),g.append(n),r.clear(),L(e,t[0].prev,t[v-1].next)}He(l,()=>{for(var h=0;h<v;h++){var u=t[h];p||(r.delete(u.k),L(e,u.prev,u.next)),We(u.e,!p)}})}function pe(e,t,n,r,l,v=null){var x=e,p={items:new Map,first:null},g=null,h=!1,u=z(()=>{var b=n();return Ge(b)?b:b==null?[]:xe(b)});Ne(()=>{var b=m(u),_=b.length;h&&_===0||(h=_===0,bt(b,p,x,l,t,r,n),v!==null&&(_===0?g?ye(g):g=we(()=>v(x)):g!==null&&Ce(g,()=>{g=null})),m(u))})}function bt(e,t,n,r,l,v,x){var p=e.length,g=t.items,h=t.first,u=h,b,_=null,E=[],k=[],I,$,S,a;for(a=0;a<p;a+=1){if(I=e[a],$=v(I,a),S=g.get($),S===void 0){var s=u?u.e.nodes_start:n;_=mt(s,t,_,_===null?t.first:_.next,I,$,a,r,l,x),g.set($,_),E=[],k=[],u=_.next;continue}if(gt(S,I,a),S.e.f&Q&&ye(S.e),S!==u){if(b!==void 0&&b.has(S)){if(E.length<k.length){var i=k[0],o;_=i.prev;var c=E[0],d=E[E.length-1];for(o=0;o<E.length;o+=1)ve(E[o],i,n);for(o=0;o<k.length;o+=1)b.delete(k[o]);L(t,c.prev,d.next),L(t,_,c),L(t,d,i),u=i,_=d,a-=1,E=[],k=[]}else b.delete(S),ve(S,u,n),L(t,S.prev,S.next),L(t,S,_===null?t.first:_.next),L(t,_,S),_=S;continue}for(E=[],k=[];u!==null&&u.k!==$;)u.e.f&Q||(b??(b=new Set)).add(u),k.push(u),u=u.next;if(u===null)continue;S=u}E.push(S),_=S,u=S.next}if(u!==null||b!==void 0){for(var w=b===void 0?[]:xe(b);u!==null;)u.e.f&Q||w.push(u),u=u.next;var f=w.length;if(f>0){var y=null;_t(t,w,y,g)}}Y.first=t.first&&t.first.e,Y.last=_&&_.e}function gt(e,t,n,r){Fe(e.v,t),e.i=n}function mt(e,t,n,r,l,v,x,p,g,h){var u=(g&ze)!==0,b=(g&Ye)===0,_=u?b?ne(l):se(l):l,E=g&qe?se(x):x,k={i:E,v:_,k:v,a:null,e:null,prev:n,next:r};try{return k.e=we(()=>p(e,_,E,h),Ie),k.e.prev=n&&n.e,k.e.next=r&&r.e,n===null?t.first=k:(n.next=k,n.e.next=k.e),r!==null&&(r.prev=k,r.e.prev=k.e),k}finally{}}function ve(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,l=t?t.e.nodes_start:n,v=e.e.nodes_start;v!==r;){var x=je(v);l.before(v),v=x}}function L(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function $e(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(n=$e(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function ht(){for(var e,t,n=0,r="",l=arguments.length;n<l;n++)(e=arguments[n])&&(t=$e(e))&&(r&&(r+=" "),r+=t);return r}function _e(e){return typeof e=="object"?ht(e):e??""}function be(e,t,n){var r=e.__className,l=yt(t);(r!==l||Ie)&&(t==null?e.removeAttribute("class"):e.className=l,e.__className=l)}function yt(e,t){return(e??"")+""}function Ae(e,t,n){if(e==null)return t(void 0),B;const r=G(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const q=[];function ge(e,t=B){let n=null;const r=new Set;function l(p){if(Je(e,p)&&(e=p,n)){const g=!q.length;for(const h of r)h[1](),q.push(h,e);if(g){for(let h=0;h<q.length;h+=2)q[h][0](q[h+1]);q.length=0}}}function v(p){l(p(e))}function x(p,g=B){const h=[p,g];return r.add(h),r.size===1&&(n=t(l,v)||B),p(e),()=>{r.delete(h),r.size===0&&n&&(n(),n=null)}}return{set:l,update:v,subscribe:x}}function ee(e){let t;return Ae(e,n=>t=n)(),t}let j=!1,te=Symbol();function wt(e,t,n){const r=n[t]??(n[t]={store:null,source:ne(void 0),unsubscribe:B});if(r.store!==e&&!(te in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=B;else{var l=!0;r.unsubscribe=Ae(e,v=>{l?r.source.v=v:X(r.source,v)}),l=!1}return e&&te in n?ee(e):m(r.source)}function xt(){const e={};function t(){Xe(()=>{for(var n in e)e[n].unsubscribe();Ke(e,te,{enumerable:!1,value:!0})})}return[e,t]}function kt(e,t,n){return e.set(n),t}function St(e){var t=j;try{return j=!1,[e(),j]}finally{j=t}}function me(e){for(var t=Y,n=Y;t!==null&&!(t.f&(st|ot));)t=t.parent;try{return oe(t),e()}finally{oe(n)}}function Et(e,t,n,r){var c;var l=(n&ut)!==0,v=!at||(n&rt)!==0,x=(n&it)!==0,p=!1,g;[g,p]=St(()=>e[t]);var h=tt in e||nt in e,u=(((c=Qe(e,t))==null?void 0:c.set)??(h&&t in e&&(d=>e[t]=d)))||void 0,b=r,_=!0,E=!1,k=()=>(E=!0,_&&(_=!1,b=r),b),I;if(v)I=()=>{var d=e[t];return d===void 0?k():(_=!0,E=!1,d)};else{var $=me(()=>(l?ie:z)(()=>e[t]));$.f|=Ze,I=()=>{var d=m($);return d!==void 0&&(b=void 0),d===void 0?b:d}}if(u){var S=e.$$legacy;return function(d,w){return arguments.length>0?((!v||!w||S||p)&&u(w?I():d),d):I()}}var a=!1,s=!1,i=ne(g),o=me(()=>ie(()=>{var d=I(),w=m(i);return a?(a=!1,s=!0,w):(s=!1,i.v=d)}));return o.equals=et,function(d,w){if(lt!==null&&(a=s,I(),m(i)),arguments.length>0){const f=w?m(o):v&&x?vt(d):d;return o.equals(f)||(a=!0,X(i,f),E&&b!==void 0&&(b=f),G(()=>m(o))),d}return m(o)}}const Te=(e,t)=>{switch(e){case A.afktimer:case A.buff:case A.model:case A.stat:return!1;case A.chat:case A.popup:return;case A.xpgain:return t?!1:void 0}},U=[];for(let e=0;e<256;++e)U.push((e+256).toString(16).slice(1));function Rt(e,t=0){return(U[e[t+0]]+U[e[t+1]]+U[e[t+2]]+U[e[t+3]]+"-"+U[e[t+4]]+U[e[t+5]]+"-"+U[e[t+6]]+U[e[t+7]]+"-"+U[e[t+8]]+U[e[t+9]]+"-"+U[e[t+10]]+U[e[t+11]]+U[e[t+12]]+U[e[t+13]]+U[e[t+14]]+U[e[t+15]]).toLowerCase()}let Z;const Ut=new Uint8Array(16);function It(){if(!Z){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Z=crypto.getRandomValues.bind(crypto)}return Z(Ut)}const $t=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),he={randomUUID:$t};function J(e,t,n){var l;if(he.randomUUID&&!e)return he.randomUUID();e=e||{};const r=e.random??((l=e.rng)==null?void 0:l.call(e))??It();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Rt(r)}const At=()=>fetch("https://bolt-api/send-message",{method:"POST",body:new Uint8Array([1,0])});var Tt=(e,t,n)=>t(m(n),!1),Ot=V('<button class="h-[14px] w-[14px] pointer-events-auto"><img src="plugin://app/images/caret-down-solid.svg" class="w-full h-full" alt="Hide"></button>'),Pt=(e,t,n)=>t(m(n),!0),Dt=V('<button class="h-[14px] w-[14px] pointer-events-auto"><img src="plugin://app/images/caret-down-solid.svg" class="w-full h-full rotate-270" alt="Expand"></button>'),Lt=(e,t,n)=>t(m(n)),Mt=(e,t,n)=>t(m(n)),Nt=(e,t,n)=>t(m(n)),Ct=(e,t,n,r)=>t(m(n),m(r)),Ft=(e,t,n,r)=>t(m(n),m(r)),qt=V('<div> <button class="absolute rounded-lg right-0 top-0 h-[18px] w-[18px] hover:bg-red-500 pointer-events-auto py-0 by-0" title="Delete"><img src="plugin://app/images/xmark-solid.svg" class="w-full h-full" alt="Delete"></button> <button class="absolute rounded-lg right-[18px] top-0 h-[18px] w-[18px] hover:bg-blue-400 pointer-events-auto py-0 by-0" title="Edit"><img src="plugin://app/images/gear-solid.svg" class="absolute top-[2px] left-[2px] w-[14px] h-[14px]" alt="Edit"></button></div>'),Bt=V('<div><!> <button class="absolute rounded-lg right-0 top-0 h-[18px] w-[18px] hover:bg-red-500 pointer-events-auto py-0 by-0" title="Delete"><img src="plugin://app/images/xmark-solid.svg" class="w-full h-full" alt="Delete"></button> <button class="absolute rounded-lg right-[18px] top-0 h-[18px] w-[18px] hover:bg-blue-400 pointer-events-auto py-0 by-0" title="Edit"><img src="plugin://app/images/gear-solid.svg" class="absolute top-[2px] left-[2px] w-[14px] h-[14px]" alt="Edit"></button> <button class="absolute rounded-lg right-[36px] top-0 h-[18px] w-[18px] hover:bg-emerald-400 pointer-events-auto py-0 by-0" title="Add rule"><img src="plugin://app/images/plus-solid.svg" class="w-full h-full" alt="Add rule"></button></div> <!>',1),Vt=V('<div><!> <button class="rounded-sm my-1 px-2 py-1 bg-emerald-400 pointer-events-auto hover:opacity-75">Add ruleset</button></div>');function Ht(e,t){Se(t,!1);const[n,r]=xt(),l=()=>wt(p(),"$list",n),v=(a,s)=>{let i=0;const o=f=>{s&&s.setUint8(i,f?1:0),i+=1},c=f=>{s&&s.setUint32(i,f,!0),i+=4},d=f=>{s&&s.setInt32(i,f,!0),i+=4},w=f=>{const y=new TextEncoder().encode(f);if(c(f.length),s)for(let T=0;T<y.byteLength;T+=1)s.setUint8(i+T,y[T]);i+=y.byteLength};c(a.length);for(const f of a){w(f.id),o(f.alert),o(f.doFlashWindow),o(f.onlyIfUnfocused),c(Object.keys(f.rules).length);for(const y of Object.values(f.rules)){w(y.id),w(y.ruletype);const T=typeof y.alert=="boolean",O=typeof y.number=="number",N=typeof y.ref=="string",C=typeof y.comparator=="string",H=typeof y.find=="string";o(T),T&&o(y.alert===!0),o(O),O&&d(y.number),o(N),N&&w(y.ref),o(C),C&&w(y.comparator),o(H),H&&w(y.find)}}return i};window.addEventListener("message",a=>{if(!a.data||typeof a.data!="object"||a.data.type!=="pluginMessage")return;const s=new Uint16Array(a.data.content.slice(0,2))[0];switch(s){case 1:{const i=new URLSearchParams(new TextDecoder().decode(a.data.content.slice(2)));let o=i.get("id"),c=null;o?c=ee(p())[o]:o=J(),kt(p(),G(l)[o]={id:o,name:i.get("name"),rules:c?c.rules:{},expanded:c?c.expanded:!1,alert:c?c.alert:!1,doFlashWindow:i.get("flash_window")==="1",sound:i.get("sound")??void 0,volume:parseInt(i.get("volume")),onlyIfUnfocused:i.get("only_if_unfocused")==="1"},G(l));break}case 2:{const i=new URLSearchParams(new TextDecoder().decode(a.data.content.slice(2))),o=l(),c=o[i.get("ruleset_id")];let d=i.get("id"),w=null;d?w=c.rules[d]:d=J();const f=i.get("number"),y=i.get("type");c.rules[d]={id:d,ruletype:y,alert:w?w.alert:Te(y,!!f),number:f?parseInt(f):void 0,ref:i.get("ref")??void 0,comparator:i.get("comparator")??void 0,find:i.get("find")??void 0},c.expanded=!0,p().set(o);break}default:console.error(`unknown message type ${s}`)}});let x=Ue(!1),p=Et(t,"list",12);const g=a=>{let s={id:a.id,name:a.name,only_if_unfocused:a.onlyIfUnfocused?"1":"0",flash_window:a.doFlashWindow?"1":"0",volume:a.volume.toString()};a.sound&&(s.sound=a.sound);const i="\0".concat(new URLSearchParams(s).toString());fetch("https://bolt-api/send-message",{method:"POST",body:i})},h=a=>{let s={ruleset_id:a.id};const i="\0".concat(new URLSearchParams(s).toString());fetch("https://bolt-api/send-message",{method:"POST",body:i})},u=(a,s)=>{let i={ruleset_id:a.id,id:s.id,type:s.ruletype};s.number&&(i.number=s.number.toString()),s.ref&&(i.ref=s.ref),s.comparator&&(i.comparator=s.comparator),s.find&&(i.find=s.find);const o="\0".concat(new URLSearchParams(i).toString());fetch("https://bolt-api/send-message",{method:"POST",body:o})},b=a=>{const s=ee(p());delete s[a.id],p().set(s)},_=(a,s)=>{delete a.rules[s.id],p().set(l())},E=(a,s)=>{a.expanded=s,p(p())},k=a=>{switch(a.ruletype){case A.afktimer:return typeof a.number!="number"?"afk timer":`afk timer (${Math.floor(a.number/1e6)} sec)`;case A.buff:switch(a.comparator){case"active":return`buff '${a.ref}' active`;case"inactive":return`buff '${a.ref}' inactive`;case"lessthan":return`buff '${a.ref}' < ${a.number}`;case"greaterthan":return`buff '${a.ref}' > ${a.number}`;case"parenslessthan":return`buff '${a.ref}' parentheses < ${a.number}`;case"parenscreaterthan":return`buff '${a.ref}' parentheses > ${a.number}`;default:return`buff '${a.ref}'`}case A.chat:return`chat text: '${a.find}'`;case A.model:return`3D model: '${a.ref}'`;case A.popup:return`popup text: '${a.find}'`;case A.stat:return typeof a.number!="number"?`stat '${a.ref}'`:`stat '${a.ref}' < ${a.number}%`;case A.xpgain:return typeof a.number!="number"?"xp gain":`xp gain timeout (${Math.floor(a.number/1e6)} sec)`;default:return"unknown"}};ct(()=>(l(),m(x)),()=>{const a=l();if(m(x)||Object.keys(a).length>0){const s=Object.values(a),i=v(s,null),o=new ArrayBuffer(i+2);new DataView(o,0,2).setUint16(0,5,!0),v(s,new DataView(o,2,i)),fetch("https://bolt-api/send-message",{method:"POST",body:o})}if(m(x)){const s=Object.values(a).map(o=>({name:o.name,rules:Object.values(o.rules).map(c=>({ruletype:c.ruletype,number:c.number,ref:c.ref,comparator:c.comparator,find:c.find})),doFlashWindow:o.doFlashWindow,sound:o.sound,volume:o.volume,onlyIfUnfocused:o.onlyIfUnfocused})),i="\0".concat(JSON.stringify(s));fetch("https://bolt-api/send-message",{method:"POST",body:i})}else X(x,!0)}),dt(),Ee();var I=Vt(),$=M(I);pe($,1,()=>Object.values(l()),fe,(a,s,i)=>{var o=Bt(),c=le(o),d=M(c);{var w=P=>{var D=Ot();D.__click=[Tt,E,s],F(P,D)},f=P=>{var D=Dt();D.__click=[Pt,E,s],F(P,D)};ue(d,P=>{m(s).expanded?P(w):P(f,!1)})}var y=R(d),T=R(y);T.__click=[Lt,b,s];var O=R(T,2);O.__click=[Mt,g,s];var N=R(O,2);N.__click=[Nt,h,s];var C=R(c,2);{var H=P=>{var D=ft(),Oe=le(D);pe(Oe,1,()=>Object.values(m(s).rules),fe,(Pe,W)=>{var K=qt(),ae=M(K),re=R(ae);re.__click=[Ct,_,s,W];var De=R(re,2);De.__click=[Ft,u,s,W],ce((Le,Me)=>{be(K,_e(Le)),de(ae,`${Me??""} `)},[()=>"relative px-1 w-full text-[8pt] ".concat(m(W).alert?"bg-red-400":i&1?"bg-gray-200":"bg-gray-300"),()=>k(m(W))],z),F(Pe,K)}),F(P,D)};ue(C,P=>{m(s).expanded&&P(H)})}ce(P=>{be(c,_e(P)),de(y,` ${m(s).name??""} `)},[()=>"relative w-full text-[8pt] ".concat(m(s).alert?"bg-red-400":i&1?"bg-gray-200":"bg-gray-300")],z),F(a,o)});var S=R($,2);S.__click=[At],F(e,I),Re(),r()}ke(["click"]);const Wt=()=>fetch("https://bolt-api/close-request");var jt=(e,t)=>{e.button===0&&t("-1","-1")},zt=(e,t)=>{e.button===0&&t("0","-1")},Yt=(e,t)=>{e.button===0&&t("1","-1")},Gt=(e,t)=>{e.button===0&&t("-1","0")},Jt=(e,t)=>{e.button===0&&t("1","0")},Xt=(e,t)=>{e.button===0&&t("-1","1")},Kt=(e,t)=>{e.button===0&&t("0","1")},Qt=(e,t)=>{e.button===0&&t("1","1")},Zt=(e,t)=>{e.button===0&&t("0","0")},en=V('<main><div class="absolute grid grid-cols-[5px_auto_5px] grid-rows-[5px_auto_5px] top-0 left-0 bottom-0 right-0 z-100 pointer-events-none"><div class="bg-black pointer-events-auto select-none"></div> <div class="bg-black pointer-events-auto select-none"></div> <div class="bg-black pointer-events-auto select-none"></div> <div class="bg-black pointer-events-auto select-none"></div> <div class="pointer-events-none"></div> <div class="bg-black pointer-events-auto select-none"></div> <div class="bg-black pointer-events-auto select-none"></div> <div class="bg-black pointer-events-auto select-none"></div> <div class="bg-black pointer-events-auto select-none"></div></div> <div class="m-[7px] w-auto h-auto"><div class="m-0 p-0 border-b border-black absolute top-[5px] right-[5px] w-[18px] h-[19px]"><button class="m-0 p-0 absolute top-0 left-0 w-full h-full select-none text-center text-[12px] bg-[hsl(0,70%,50%)] hover:bg-[hsl(0,100%,50%)]">X</button></div> <div class="m-0 p-0 border-b border-black absolute left-[5px] top-[5px] right-[23px] h-[19px] bg-[grey] text-center text-[10pt]"><p class="m-0 p-0 color-black select-none pointer-events-none">Alerts</p></div> <div class="fixed top-[24px] bottom-[6px] left-[5px] right-[5px] text-[10pt] pointer-events-none"><!></div></div></main>');function tn(e,t){Se(t,!1);const n=new URLSearchParams(window.location.search);let r=Ue((o=>{const c=o.get("list");if(!c)return ge({});const d=JSON.parse(atob(c));let w={};for(const f of d){let y={};for(const O of f.rules){const N=J(),C=O.ruletype;y[N]={id:N,ruletype:C,alert:Te(C,!!O.number),number:O.number,ref:O.ref,comparator:O.comparator,find:O.find}}const T=J();w[T]={id:T,name:f.name,rules:y,expanded:!1,alert:!1,doFlashWindow:f.doFlashWindow,sound:f.sound,volume:f.volume,onlyIfUnfocused:f.onlyIfUnfocused}}return ge(w)})(n));const l=(o,c)=>fetch("https://bolt-api/start-reposition?".concat(new URLSearchParams({h:o,v:c}).toString()));Ee();var v=en(),x=M(v),p=M(x);p.__mousedown=[jt,l];var g=R(p,2);g.__mousedown=[zt,l];var h=R(g,2);h.__mousedown=[Yt,l];var u=R(h,2);u.__mousedown=[Gt,l];var b=R(u,4);b.__mousedown=[Jt,l];var _=R(b,2);_.__mousedown=[Xt,l];var E=R(_,2);E.__mousedown=[Kt,l];var k=R(E,2);k.__mousedown=[Qt,l];var I=R(x,2),$=M(I),S=M($);S.__click=[Wt];var a=R($,2);a.__mousedown=[Zt,l];var s=R(a,2),i=M(s);Ht(i,{get list(){return m(r)},set list(o){X(r,o)},$$legacy:!0}),F(e,v),Re()}ke(["mousedown","click"]);pt(tn,{target:document.body});
